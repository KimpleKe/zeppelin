{"paragraphs":[{"config":{"colWidth":12,"graph":{"mode":"table","height":300,"optionOpen":false,"keys":[],"values":[],"groups":[],"scatter":{}},"enabled":true,"editorMode":"ace/mode/markdown"},"settings":{"params":{},"forms":{}},"jobName":"paragraph_1481769251827_1420008619","id":"20161215-023411_290463581","dateCreated":"2016-12-15T02:34:11+0000","status":"FINISHED","progressUpdateIntervalMs":500,"focus":true,"$$hashKey":"object:1015","text":"%md\n\n## Use SQL to create table from csv files on s3 (spark.csv should be part of spark 2.0.2 so the using syntax might be outdated)","dateUpdated":"2016-12-15T02:40:27+0000","dateFinished":"2016-12-15T02:40:27+0000","dateStarted":"2016-12-15T02:40:27+0000","result":{"code":"SUCCESS","type":"HTML","msg":"<h2>Use SQL to create table from csv files on s3 (spark.csv should be part of spark 2.0.2 so the using syntax might be outdated)</h2>\n"}},{"config":{"colWidth":12,"graph":{"mode":"table","height":300,"optionOpen":false,"keys":[],"values":[],"groups":[],"scatter":{}},"enabled":true,"editorMode":"ace/mode/scala"},"settings":{"params":{},"forms":{}},"jobName":"paragraph_1481769344463_591967689","id":"20161215-023544_60695490","dateCreated":"2016-12-15T02:35:44+0000","status":"RUNNING","progressUpdateIntervalMs":500,"focus":true,"$$hashKey":"object:1085","text":"%spark.sql\n\ndrop table if exists basic\n\n\n","dateUpdated":"2016-12-15T02:43:41+0000","dateFinished":"2016-12-15T02:43:19+0000","dateStarted":"2016-12-15T02:43:41+0000","result":{"code":"ERROR","type":"TEXT","msg":"\nmismatched input ';' expecting <EOF>(line 1, pos 26)\n\n== SQL ==\ndrop table if exists basic;\n--------------------------^^^\n\nCREATE TABLE basic\nUSING com.databricks.spark.csv\nOPTIONS (path \"s3://rea-consumer-data-qa/ben-kuai/seg-training/mobappbasic\", header \"true\", inferSchema \"true\");\n\nset zeppelin.spark.sql.stacktrace = true to see full stacktrace"}},{"config":{"colWidth":12,"graph":{"mode":"table","height":300,"optionOpen":false,"keys":[],"values":[],"groups":[],"scatter":{}},"enabled":true},"settings":{"params":{},"forms":{}},"jobName":"paragraph_1481769813124_32432230","id":"20161215-024333_1569534505","dateCreated":"2016-12-15T02:43:33+0000","status":"READY","progressUpdateIntervalMs":500,"focus":true,"$$hashKey":"object:1637","text":"%spark.sql\n\nCREATE TABLE basic\nUSING com.databricks.spark.csv\nOPTIONS (path \"s3://rea-consumer-data-qa/ben-kuai/seg-training/mobappbasic\", header \"true\", inferSchema \"true\")","dateUpdated":"2016-12-15T02:43:48+0000"},{"config":{"colWidth":12,"graph":{"mode":"scatterChart","height":300,"optionOpen":false,"keys":[{"name":"Date","index":0,"aggr":"sum"}],"values":[{"name":"My Rea ID (evar54)","index":1,"aggr":"sum"}],"groups":[],"scatter":{"xAxis":{"name":"Date","index":0,"aggr":"sum"},"yAxis":{"name":"My Rea ID (evar54)","index":1,"aggr":"sum"}}},"enabled":true},"settings":{"params":{},"forms":{}},"jobName":"paragraph_1481769373537_-2071017366","id":"20161215-023613_1743540149","dateCreated":"2016-12-15T02:36:13+0000","status":"FINISHED","progressUpdateIntervalMs":500,"focus":true,"$$hashKey":"object:1155","text":"%spark.sql\n\nselect * from basic","dateUpdated":"2016-12-15T02:39:33+0000","dateFinished":"2016-12-15T02:39:34+0000","dateStarted":"2016-12-15T02:39:34+0000","errorMessage":""},{"config":{"colWidth":12,"graph":{"mode":"table","height":300,"optionOpen":false,"keys":[],"values":[],"groups":[],"scatter":{}},"enabled":true,"editorMode":"ace/mode/markdown"},"settings":{"params":{},"forms":{}},"jobName":"paragraph_1481769388814_642647275","id":"20161215-023628_1726377983","dateCreated":"2016-12-15T02:36:28+0000","status":"FINISHED","progressUpdateIntervalMs":500,"focus":true,"$$hashKey":"object:1225","dateUpdated":"2016-12-15T02:41:05+0000","dateFinished":"2016-12-15T02:41:05+0000","dateStarted":"2016-12-15T02:41:05+0000","result":{"code":"SUCCESS","type":"HTML","msg":"<h2>Load csv from s3 into dataframe first and create temp table then use sql against the table</h2>\n"},"text":"%md\n\n## Load csv from s3 into dataframe first and create temp table then use sql against the table"},{"text":"\nimport org.apache.spark.sql._\n\ndef loadDF(path:String)={\n    val df = spark.read.option(\"header\",\"true\").csv(s\"${path}\")\n    df.cache\n    df.printSchema\n    println(df.count)\n    println(df.first)\n    df \n}\n\nval reportBasePath = \"s3://rea-consumer-data-qa/ben-kuai/seg-training/\"\n\ndef loadReport(report:String)= loadDF(s\"${reportBasePath}${report}/\")\n\nval basicDF = loadReport(\"mobappbasic\")\nbasicDF.registerTempTable(\"basic_df\")\n","dateUpdated":"2016-12-15T02:39:33+0000","config":{"colWidth":12,"editorMode":"ace/mode/scala","graph":{"mode":"table","height":300,"optionOpen":false,"keys":[],"values":[],"groups":[],"scatter":{}},"enabled":true},"settings":{"params":{},"forms":{}},"jobName":"paragraph_1481761737651_194754169","id":"20161214-021904_770274371","dateCreated":"2016-12-15T00:28:57+0000","dateStarted":"2016-12-15T02:39:34+0000","dateFinished":"2016-12-15T02:39:38+0000","status":"FINISHED","progressUpdateIntervalMs":500,"$$hashKey":"object:180","errorMessage":""},{"text":"%spark.sql\nselect * from basic_df","dateUpdated":"2016-12-15T02:39:33+0000","config":{"colWidth":12,"editorMode":"ace/mode/sql","graph":{"mode":"table","height":972.5999755859375,"optionOpen":false,"keys":[{"name":"Site Section (c) (evar16)","index":0,"aggr":"sum"}],"values":[],"groups":[],"scatter":{"xAxis":{"name":"Site Section (c) (evar16)","index":0,"aggr":"sum"}}},"enabled":true},"settings":{"params":{},"forms":{}},"jobName":"paragraph_1481761737651_194754169","id":"20161214-024248_214336164","dateCreated":"2016-12-15T00:28:57+0000","dateStarted":"2016-12-15T02:39:34+0000","dateFinished":"2016-12-15T02:39:38+0000","status":"FINISHED","progressUpdateIntervalMs":500,"$$hashKey":"object:184","errorMessage":"","focus":true},{"config":{"colWidth":12,"graph":{"mode":"table","height":300,"optionOpen":false,"keys":[],"values":[],"groups":[],"scatter":{}},"enabled":true},"settings":{"params":{},"forms":{}},"jobName":"paragraph_1481769573813_-1740073659","id":"20161215-023933_585269000","dateCreated":"2016-12-15T02:39:33+0000","status":"READY","progressUpdateIntervalMs":500,"focus":true,"$$hashKey":"object:1377","dateUpdated":"2016-12-15T02:39:44+0000","errorMessage":"","text":""}],"name":"spark-sql","id":"2C3GCUFDC","angularObjects":{"2BRWU4WXC:shared_process":[],"2AM1YV5CU:shared_process":[],"2AJXGMUUJ:shared_process":[],"2ANGGHHMQ:shared_process":[],"2AKK3QQXU:shared_process":[]},"config":{"looknfeel":"default"},"info":{}}